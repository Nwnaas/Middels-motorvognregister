<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Middels-Motorvognregister</title>
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
        function generateRandomValidPersonNr() {
            let randomPersonNr;
            do {
                randomPersonNr = generateRandomPersonNr();
            } while (!validatePersonNr(randomPersonNr));
            return randomPersonNr;
        }
    </script>
</head>
<body>

<h1>Middels Motorvognregister</h1>

<form id="bilForm">

    <label for="personNr">Eiers personnummer:</label>
    <input type="text" id="personNr" name="personNr" maxlength="11" required><br><br>

    <label for="navn">Eiers navn:</label>
    <input type="text" id="navn" name="navn" required><br><br>

    <label for="adresse">Eiers adresse:</label>
    <input type="text" list="gateadresseListe" id="adresse" name="adresse" required><br><br>
    <datalist id="gateadresseListe"></datalist>

    <label for="bilSkilt">Bilskilt:</label>
    <input type="text" id="bilSkilt" name="bilSkilt" minlength="7" maxlength="7" required><br><br>

    <label for="bilMerke">Bilmerke:</label>
    <input type="text" list="bilMerkeList" id="bilMerke" name="bilMerke" required><br><br>

    <datalist id="bilMerkeList">
        <option value="Toyota"></option>
        <option value="Volkswagen"></option>
        <option value="Ford"></option>
        <option value="Chevrolet"></option>
        <option value="Nissan"></option>
        <option value="Honda"></option>
        <option value="Mercedes-Benz"></option>
        <option value="BMW"></option>
        <option value="Audi"></option>
        <option value="Hyundai"></option>
        <option value="Tesla"></option>
        <option value="Volvo"></option>
        <option value="Kia"></option>
        <option value="Subaru"></option>
        <option value="Mazda"></option>
        <option value="Lexus"></option>
        <option value="Jeep"></option>
        <option value="Ram"></option>
        <option value="Porsche"></option>
        <option value="Acura"></option>
        <option value="Infiniti"></option>
        <option value="Land Rover"></option>
        <option value="Jaguar"></option>
        <option value="Fiat"></option>
        <option value="Mitsubishi"></option>
        <option value="Buick"></option>
        <option value="GMC"></option>
        <option value="Chrysler"></option>
        <option value="Dodge"></option>
        <option value="Cadillac"></option>
        <option value="Lincoln"></option>
        <option value="Mini"></option>
        <option value="Alfa Romeo"></option>
        <option value="Ferrari"></option>
        <option value="Lamborghini"></option>
        <option value="Maserati"></option>
        <option value="Bentley"></option>
        <option value="Rolls-Royce"></option>
        <option value="Aston Martin"></option>
        <option value="McLaren"></option>
        <option value="Bugatti"></option>
        <option value="Lotus"></option>
        <option value="Genesis"></option>
        <option value="Rivian"></option>
        <option value="Lucid"></option>
        <option value="Polestar"></option>
        <option value="Jaguar"></option>
        <option value="Koenigsegg"></option>
        <option value="Pagani"></option>
        <option value="Fisker"></option>
        <option value="Byton"></option>
    </datalist>

    <label for="bilModel">Bilmodel:</label>
    <input type="text" list="bilModelList" id="bilModel" name="bilModel" required><br><br>
    <datalist id="bilModelList"></datalist>

    <label for="bilFarge">Bilfarge:</label>
    <input type="text" list="bilFargeList" id="bilFarge" name="bilFarge" required>

    <datalist id="bilFargeList">
        <option value="Svart" data-farge="#000000">Svart</option>
        <option value="Hvit" data-farge="#FFFFFF">Hvit</option>
        <option value="Rød" data-farge="#FF0000">Rød</option>
        <option value="Grønn" data-farge="#00FF00">Grønn</option>
        <option value="Blå" data-farge="#0000FF">Blå</option>
        <option value="Gul" data-farge="#FFFF00">Gul</option>
        <option value="Oransje" data-farge="#FFA500">Oransje</option>
        <option value="Lilla" data-farge="#800080">Lilla</option>
        <option value="Rosa" data-farge="#FFC0CB">Rosa</option>
        <option value="Brun" data-farge="#A52A2A">Brun</option>
        <option value="Gull" data-farge="#FFD700">Gull</option>
        <option value="Sølv" data-farge="#C0C0C0">Sølv</option>
        <option value="Grå" data-farge="#808080">Grå</option>
        <option value="Turkis" data-farge="#40E0D0">Turkis</option>
        <option value="Indigo" data-farge="#4B0082">Indigo</option>
        <option value="Mørkerød" data-farge="#8B0000">Mørkerød</option>
        <option value="Limegrønn" data-farge="#00FF00">Limegrønn</option>
        <option value="Koboltblå" data-farge="#0000FF">Koboltblå</option>
        <option value="Beige" data-farge="#F5F5DC">Beige</option>
        <option value="Korall" data-farge="#FF7F50">Korall</option>
        <option value="Olivengrønn" data-farge="#808000">Olivengrønn</option>
        <option value="Sjokoladebrun" data-farge="#D2691E">Sjokoladebrun</option>
        <option value="Malakittgrønn" data-farge="#00FA9A">Malakittgrønn</option>
        <option value="Aubergine" data-farge="#9932CC">Aubergine</option>
        <option value="Mauve" data-farge="#E0B0FF">Mauve</option>
        <option value="Sennepsgul" data-farge="#FFDB58">Sennepsgul</option>
        <option value="Vinrød" data-farge="#800000">Vinrød</option>
        <option value="Teal" data-farge="#008080">Teal</option>
        <option value="Smaragdgrønn" data-farge="#008000">Smaragdgrønn</option>
        <option value="Perlegrå" data-farge="#DCDCDC">Perlegrå</option>
        <option value="Kirsebærrød" data-farge="#DE3163">Kirsebærrød</option>
        <option value="Karamell" data-farge="#D2691E">Karamell</option>
        <option value="Skyblå" data-farge="#87CEEB">Skyblå</option>
        <option value="Kobber" data-farge="#B87333">Kobber</option>
        <option value="Burgunder" data-farge="#800020">Burgunder</option>
    </datalist>

    <button type="button" onclick="addProdukt()">Registrer</button>
    <button type="button" onclick="fillFormAutomatically()">Legg til 20 brukere</button>
</form>

<h2>Motorvognregister</h2>

<label for="search">Søk etter navn eller bil:</label>
<input type="text" id="search" name="search" oninput="searchTable()" placeholder="Søk etter navn eller bil">
<br><br>

<table id="bilTable">
    <tr>
        <th>PersonNr</th>
        <th>Kjonn</th>
        <th>Navn</th>
        <th>Adresse</th>
        <th>Bilskilt</th>
        <th>Bilmerke</th>
        <th>Bilmodel</th>
        <th>Bilfarge</th>
        <th>Registrerings Sted</th>
        <th><button onclick=" slettKundene()" id="slettAlle">Slett Alle</button></th>
    </tr>
</table>

<script>
    function scrollToTable() {
        // Get the target element by id
        var targetElement = document.getElementById("bilTable");

        // Scroll to the target element
        targetElement.scrollIntoView({ behavior: "smooth" });
    }

    function slettKundene() {
        $.get("/slettAlle", hentAlle);
    }

    function hentAlle() {
        $.get("/hentAlle", formaterData);
    }

    function formaterData(bil) {
        const headerRow = "<tr><th>PersonNr</th><th>Kjønn</th><th>Navn</th><th>Adresse</th><th>Bilskilt</th><th>Bilmerke</th><th>Bilmodel</th><th>Bilfarge</th><th>Registrerings Sted</th><th><button onclick=\" slettKundene()\" id=\"slettAlle\">Slett Alle</button></th></tr>";
        const rows = bil.map(item =>
            `<tr><td>${item.personNr}</td><td>${item.kjonn}</td><td>${item.navn}</td><td>${item.adresse}</td><td>${item.bilSkilt}</td><td>${item.bilMerke}</td><td>${item.bilModel}</td>${item.bilFarge}<td>${item.sted}</td><td>${item.fjern}</td></tr>`
        );

        $("#bilTable").html(headerRow + rows.join(''));
    }

    function highlightEmptyFields() {
        const formInputs = document.querySelectorAll('#bilForm input');
        formInputs.forEach(input => {
            if (!input.value) {
                input.classList.add('error');
            }
        });
    }

    function deleteProdukt(row) {
        const rowIndex = row.parentNode.parentNode.rowIndex;
        document.getElementById("bilTable").deleteRow(rowIndex);
    }

    document.getElementById('bilMerke').addEventListener('input', function () {
        const brand = this.value.toLowerCase().replace(/\s/g, '_').replace("-", "_");
        const models = document.getElementById('bilModelList');
        models.innerHTML = '';

        if (carModels[brand]) {
            carModels[brand].forEach(function (model) {
                const option = document.createElement('option');
                option.value = model;
                models.appendChild(option);
            });
        }
    });
</script>
<script src="js/addBil.js"></script>
<script src="js/fyllutautomatisk.js"></script>
<script src="js/KartverketAPI.js"></script>
<script src="js/lister.js"></script>
<script src="js/searchTable.js"></script>
<script src="js/validatePersonNr.js"></script>

</body>
</html>